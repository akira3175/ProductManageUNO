<Page
    x:Class="ProductManageUNO.Presentation.ProductDetailPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:ProductManageUNO.Presentation"
    xmlns:models="using:ProductManageUNO.Models"
    mc:Ignorable="d"
    Background="{ThemeResource BackgroundBrush}">

    <Grid RowDefinitions="Auto, *">
        <!-- Header -->
        <Grid Grid.Row="0" Background="{ThemeResource PrimaryBrush}" Padding="16,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Column="0" 
                    Background="Transparent"
                    BorderThickness="0"
                    VerticalAlignment="Center"
                    Click="BackButton_Click"
                    ToolTipService.ToolTip="Quay lại">
                <SymbolIcon Symbol="Back" Foreground="{ThemeResource OnPrimaryBrush}"/>
            </Button>

            <TextBlock Grid.Column="1"
                      Text="Chi Tiết Sản Phẩm" 
                      FontSize="24" 
                      FontWeight="Bold"
                      Foreground="{ThemeResource OnPrimaryBrush}"
                      VerticalAlignment="Center"
                      Margin="12,0,0,0"/>

            <ProgressRing Grid.Column="2"
                         IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}" 
                         Width="24" 
                         Height="24"
                         Foreground="{ThemeResource OnPrimaryBrush}"/>
        </Grid>

        <!-- Content Area -->
        <Grid Grid.Row="1">
            <!-- Loading State -->
            <Grid Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <StackPanel HorizontalAlignment="Center" 
                           VerticalAlignment="Center" 
                           Spacing="16">
                    <ProgressRing IsActive="True" 
                                 Width="48" 
                                 Height="48"
                                 Foreground="{ThemeResource PrimaryBrush}"/>
                    <TextBlock Text="Đang tải dữ liệu..."
                              FontSize="16"
                              Foreground="{ThemeResource OnSurfaceVariantBrush}"
                              HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>

            <!-- Error State -->
            <Grid Visibility="{x:Bind ViewModel.ErrorMessage, Mode=OneWay, Converter={StaticResource StringNotEmptyToVisibilityConverter}}">
                <StackPanel HorizontalAlignment="Center" 
                           VerticalAlignment="Center" 
                           Spacing="16">
                    <FontIcon Glyph="&#xE7BA;" 
                             FontSize="64" 
                             Foreground="{ThemeResource ErrorColor}"/>
                    <TextBlock Text="{x:Bind ViewModel.ErrorMessage, Mode=OneWay}"
                              FontSize="16"
                              Foreground="{ThemeResource OnSurfaceVariantBrush}"
                              HorizontalAlignment="Center"
                              TextWrapping="Wrap"
                              MaxWidth="300"
                              TextAlignment="Center"/>
                    <Button Content="Thử lại" 
                           Click="RetryButton_Click"
                           Style="{ThemeResource AccentButtonStyle}"/>
                </StackPanel>
            </Grid>

            <!-- Product Content -->
            <ScrollViewer Padding="16"
                         Visibility="{x:Bind ViewModel.Product, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
                <StackPanel Spacing="16">
                    <!-- Product Name Card -->
                    <Border Background="{ThemeResource SurfaceBrush}"
                           CornerRadius="12"
                           Padding="20"
                           BorderBrush="{ThemeResource OutlineVariantBrush}"
                           BorderThickness="1">
                        <StackPanel Spacing="8">
                            <TextBlock Text="Tên sản phẩm"
                                      FontSize="12"
                                      Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                      Opacity="0.7"/>
                            <TextBlock Text="{x:Bind ViewModel.Product.ProductName, Mode=OneWay}"
                                      FontSize="24"
                                      FontWeight="Bold"
                                      Foreground="{ThemeResource OnSurfaceBrush}"
                                      TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>

                    <!-- Price Card -->
                    <Border Background="{ThemeResource TertiaryContainerBrush}"
                           CornerRadius="12"
                           Padding="20"
                           BorderBrush="{ThemeResource OutlineVariantBrush}"
                           BorderThickness="1">
                        <Grid ColumnDefinitions="*,Auto">
                            <StackPanel Grid.Column="0" Spacing="4">
                                <TextBlock Text="Giá bán"
                                          FontSize="12"
                                          Foreground="{ThemeResource OnTertiaryContainerBrush}"
                                          Opacity="0.7"/>
                                <StackPanel Orientation="Horizontal" Spacing="4">
                                    <TextBlock Text="{x:Bind ViewModel.Product.Price, Mode=OneWay, Converter={StaticResource PriceFormatConverter}}"
                                              FontSize="28"
                                              FontWeight="Bold"
                                              Foreground="{ThemeResource OnTertiaryContainerBrush}"/>
                                    <TextBlock Text="VNĐ"
                                              FontSize="16"
                                              FontWeight="SemiBold"
                                              Foreground="{ThemeResource OnTertiaryContainerBrush}"
                                              VerticalAlignment="Bottom"
                                              Margin="0,0,0,4"
                                              Opacity="0.8"/>
                                </StackPanel>
                            </StackPanel>
                            <Border Grid.Column="1"
                                   Background="{ThemeResource OnTertiaryContainerBrush}"
                                   CornerRadius="8"
                                   Padding="12,6"
                                   VerticalAlignment="Center"
                                   Opacity="0.15">
                                <FontIcon Glyph="&#xE8EC;" 
                                         FontSize="32"
                                         Foreground="{ThemeResource OnTertiaryContainerBrush}"/>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Info Grid -->
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                        <!-- Barcode -->
                        <Border Grid.Column="0"
                               Background="{ThemeResource SurfaceBrush}"
                               CornerRadius="12"
                               Padding="16"
                               BorderBrush="{ThemeResource OutlineVariantBrush}"
                               BorderThickness="1">
                            <StackPanel Spacing="8">
                                <Grid ColumnDefinitions="Auto,*">
                                    <FontIcon Grid.Column="0" 
                                             Glyph="&#xE1E0;" 
                                             FontSize="16"
                                             Foreground="{ThemeResource PrimaryBrush}"
                                             VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                              Text="Mã vạch"
                                              FontSize="12"
                                              Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                              Margin="8,0,0,0"
                                              VerticalAlignment="Center"/>
                                </Grid>
                                <TextBlock Text="{x:Bind ViewModel.Product.Barcode, Mode=OneWay}"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="{ThemeResource OnSurfaceBrush}"
                                          TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- Unit -->
                        <Border Grid.Column="1"
                               Background="{ThemeResource SurfaceBrush}"
                               CornerRadius="12"
                               Padding="16"
                               BorderBrush="{ThemeResource OutlineVariantBrush}"
                               BorderThickness="1">
                            <StackPanel Spacing="8">
                                <Grid ColumnDefinitions="Auto,*">
                                    <FontIcon Grid.Column="0" 
                                             Glyph="&#xE7C3;" 
                                             FontSize="16"
                                             Foreground="{ThemeResource PrimaryBrush}"
                                             VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                              Text="Đơn vị"
                                              FontSize="12"
                                              Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                              Margin="8,0,0,0"
                                              VerticalAlignment="Center"/>
                                </Grid>
                                <TextBlock Text="{x:Bind ViewModel.Product.Unit, Mode=OneWay}"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="{ThemeResource OnSurfaceBrush}"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Category Card -->
                    <Border Background="{ThemeResource SecondaryContainerBrush}"
                           CornerRadius="12"
                           Padding="20"
                           BorderBrush="{ThemeResource OutlineVariantBrush}"
                           BorderThickness="1">
                        <StackPanel Spacing="8">
                            <Grid ColumnDefinitions="Auto,*">
                                <FontIcon Grid.Column="0" 
                                         Glyph="&#xE8FD;" 
                                         FontSize="18"
                                         Foreground="{ThemeResource OnSecondaryContainerBrush}"
                                         VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1"
                                          Text="Danh mục"
                                          FontSize="12"
                                          Foreground="{ThemeResource OnSecondaryContainerBrush}"
                                          Margin="8,0,0,0"
                                          Opacity="0.7"
                                          VerticalAlignment="Center"/>
                            </Grid>
                            <TextBlock Text="{x:Bind ViewModel.Product.Category.CategoryName, Mode=OneWay}"
                                      FontSize="18"
                                      FontWeight="SemiBold"
                                      Foreground="{ThemeResource OnSecondaryContainerBrush}"/>
                        </StackPanel>
                    </Border>

                    <!-- Supplier Card -->
                    <Border Background="{ThemeResource SurfaceBrush}"
                           CornerRadius="12"
                           Padding="20"
                           BorderBrush="{ThemeResource OutlineVariantBrush}"
                           BorderThickness="1">
                        <StackPanel Spacing="12">
                            <Grid ColumnDefinitions="Auto,*">
                                <FontIcon Grid.Column="0" 
                                         Glyph="&#xE716;" 
                                         FontSize="18"
                                         Foreground="{ThemeResource PrimaryBrush}"
                                         VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1"
                                          Text="Thông tin nhà cung cấp"
                                          FontSize="16"
                                          FontWeight="SemiBold"
                                          Foreground="{ThemeResource OnSurfaceBrush}"
                                          Margin="8,0,0,0"
                                          VerticalAlignment="Center"/>
                            </Grid>

                            <StackPanel Spacing="10">
                                <!-- Name -->
                                <Grid ColumnDefinitions="Auto,*">
                                    <FontIcon Grid.Column="0" 
                                             Glyph="&#xE77B;" 
                                             FontSize="14"
                                             Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                             VerticalAlignment="Top"
                                             Margin="0,2,0,0"/>
                                    <TextBlock Grid.Column="1"
                                              Text="{x:Bind ViewModel.Product.Supplier.Name, Mode=OneWay}"
                                              FontSize="15"
                                              Foreground="{ThemeResource OnSurfaceBrush}"
                                              TextWrapping="Wrap"
                                              Margin="10,0,0,0"/>
                                </Grid>

                                <!-- Phone -->
                                <Grid ColumnDefinitions="Auto,*">
                                    <FontIcon Grid.Column="0" 
                                             Glyph="&#xE717;" 
                                             FontSize="14"
                                             Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                             VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                              Text="{x:Bind ViewModel.Product.Supplier.Phone, Mode=OneWay}"
                                              FontSize="14"
                                              Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                              Margin="10,0,0,0"/>
                                </Grid>

                                <!-- Email -->
                                <Grid ColumnDefinitions="Auto,*">
                                    <FontIcon Grid.Column="0" 
                                             Glyph="&#xE119;" 
                                             FontSize="14"
                                             Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                             VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                              Text="{x:Bind ViewModel.Product.Supplier.Email, Mode=OneWay}"
                                              FontSize="14"
                                              Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                              TextWrapping="Wrap"
                                              Margin="10,0,0,0"/>
                                </Grid>

                                <!-- Address -->
                                <Grid ColumnDefinitions="Auto,*">
                                    <FontIcon Grid.Column="0" 
                                             Glyph="&#xE707;" 
                                             FontSize="14"
                                             Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                             VerticalAlignment="Top"
                                             Margin="0,2,0,0"/>
                                    <TextBlock Grid.Column="1"
                                              Text="{x:Bind ViewModel.Product.Supplier.Address, Mode=OneWay}"
                                              FontSize="14"
                                              Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                              TextWrapping="Wrap"
                                              Margin="10,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Created Date -->
                    <Border Background="{ThemeResource SurfaceVariantBrush}"
                           CornerRadius="8"
                           Padding="16,12"
                           HorizontalAlignment="Center">
                        <Grid ColumnDefinitions="Auto,*">
                            <FontIcon Grid.Column="0" 
                                     Glyph="&#xEC92;" 
                                     FontSize="14"
                                     Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                     VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1"
                                      Text="{x:Bind ViewModel.Product.CreatedAt, Mode=OneWay, Converter={StaticResource DateFormatConverter}}"
                                      FontSize="13"
                                      Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                      Margin="8,0,0,0"
                                      VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</Page>
